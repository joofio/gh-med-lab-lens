{
  "resourceType": "Library",
  "id": "qt-prolongation-lens",
  "meta": {
    "profile": [
      "http://hl7.eu/fhir/ig/gravitate-health/StructureDefinition/lens"
    ]
  },
  "type": {
    "coding": [
      {
        "code": "logical-library"
      }
    ]
  },
  "extension": [
    {
      "url": "http://hl7.eu/fhir/ig/gravitate-health/StructureDefinition/lee-version",
      "valueString": "dev"
    }
  ],
  "url": "http://hl7.eu/fhir/ig/gravitate-health/Library/588",
  "identifier": [
    {
      "system": "http://gravitate-health.lst.tfo.upm.es",
      "value": "qt-prolongation-lens"
    }
  ],
  "version": "0.0.1",
  "name": "QT prolongation lens",
  "_name": {
    "extension": [
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "es"
          },
          {
            "url": "content",
            "valueString": "Lente para la diabetes"
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "pt"
          },
          {
            "url": "content",
            "valueString": "Lente para a diabetes"
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "da"
          },
          {
            "url": "content",
            "valueString": "Linse til diabetes"
          }
        ]
      }
    ]
  },
  "title": "qt-prolongation-lens",
  "_title": {
    "extension": [
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "es"
          },
          {
            "url": "content",
            "valueString": "Lente para la diabetes"
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "pt"
          },
          {
            "url": "content",
            "valueString": "Lente para a diabetes"
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "da"
          },
          {
            "url": "content",
            "valueString": "Linse til diabetes"
          }
        ]
      }
    ]
  },
  "status": "draft",
  "experimental": true,
  "date": "2024-06-12T12:23:10.005Z",
  "publisher": "Gravitate Health Project - UPM Team",
  "contact": [
    {
      "name": "Gravitate Health",
      "telecom": [
        {
          "system": "url",
          "value": "https://www.gravitatehealth.eu/"
        }
      ]
    }
  ],
  "description": "Lens that highlight diabetes related information",
  "_description": {
    "extension": [
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "es"
          },
          {
            "url": "content",
            "valueString": "Lente que resalta información relacionada con la diabetes"
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "pt"
          },
          {
            "url": "content",
            "valueString": "Lente que destaca informações relacionadas com a diabetes"
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "da"
          },
          {
            "url": "content",
            "valueString": "Linse der fremhæver diabetesrelaterede oplysninger"
          }
        ]
      }
    ]
  },
  "jurisdiction": [
    {
      "coding": [
        {
          "code": "EU",
          "system": "urn:iso:std:iso:3166"
        }
      ]
    }
  ],
  "purpose": "Highlight diabetes related information in a preprocessed ePI.",
  "_purpose": {
    "extension": [
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "es"
          },
          {
            "url": "content",
            "valueString": "Resaltar información relacionada con la diabetes en una ePI preprocesada."
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "pt"
          },
          {
            "url": "content",
            "valueString": "Destacar informações relacionadas com a diabetes em uma ePI pré-processada."
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "da"
          },
          {
            "url": "content",
            "valueString": "Fremhæv diabetesrelaterede oplysninger i en forbehandlet ePI."
          }
        ]
      }
    ]
  },
  "usage": "You can import this lens directly to your FHIR Server which suports Library Resource type.",
  "_usage": {
    "extension": [
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "es"
          },
          {
            "url": "content",
            "valueString": "Puedes importar esta lente directamente a tu servidor FHIR que soporte el tipo de recurso Library."
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "pt"
          },
          {
            "url": "content",
            "valueString": "Podes importar esta lente diretamente para o teu servidor FHIR que suporte o tipo de recurso Library."
          }
        ]
      },
      {
        "url": "http://hl7.org/fhir/StructureDefinition/translation",
        "extension": [
          {
            "url": "lang",
            "valueCode": "da"
          },
          {
            "url": "content",
            "valueString": "Du kan importere denne linse direkte til din FHIR-server, som understøtter ressource-typen Library."
          }
        ]
      }
    ]
  },
  "copyright": "© 2024 Gravitate Health",
  "parameter": [
    {
      "use": "in",
      "documentation": "parameter if it exists",
      "type": "CodeableConcept"
    }
  ],
  "content": [
    {
      "contentType": "application/javascript",
      "title": "Lens for diabetes",
      "data": "bGV0IGh0bWxEYXRhID0gaHRtbDsKbGV0IGlwc0RhdGEgPSBpcHM7CgpsZXQgZ2V0U3BlY2lmaWNhdGlvbiA9ICgpID0+IHsKICAgIHJldHVybiAiMS4wLjAiOwp9OwoKbGV0IGFubm90YXRpb25Qcm9jZXNzID0gKGxpc3RPZkNhdGVnb3JpZXMsIGVuaGFuY2VUYWcsIGRvY3VtZW50LCByZXNwb25zZSkgPT4gewogICAgbGlzdE9mQ2F0ZWdvcmllcy5mb3JFYWNoKChjaGVjaykgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5pbmNsdWRlcyhjaGVjaykpIHsKICAgICAgICAgICAgbGV0IGVsZW1lbnRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShjaGVjayk7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGVsZW1lbnRzW2ldLmNsYXNzTGlzdC5hZGQoZW5oYW5jZVRhZyk7CiAgICAgICAgICAgICAgICBlbGVtZW50c1tpXS5jbGFzc0xpc3QuYWRkKCJxdC1wcm9sb25nYXRpb24tbGVucyIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaGVhZCIpLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJoZWFkIilbMF0ucmVtb3ZlKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IikubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYm9keSIpWzBdLmlubmVySFRNTDsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXNwb25zZTogIiArIHJlc3BvbnNlKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJSZXNwb25zZTogIiArIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5pbm5lckhUTUwpOwogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuaW5uZXJIVE1MOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSk7CgogICAgaWYgKHJlc3BvbnNlID09IG51bGwgfHwgcmVzcG9uc2UgPT0gIiIpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoCiAgICAgICAgICAgICJBbm5vdGF0aW9uIHByb2NjZXNzIGZhaWxlZDogUmV0dXJuZWQgZW1wdHkgb3IgbnVsbCByZXNwb25zZSIKICAgICAgICApOwogICAgICAgIC8vcmV0dXJuIGh0bWxEYXRhCiAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUubG9nKCJSZXNwb25zZTogIiArIHJlc3BvbnNlKTsKICAgICAgICByZXR1cm4gcmVzcG9uc2U7CiAgICB9Cn0KCgpsZXQgYW5ub3RhdGVIVE1Mc2VjdGlvbiA9IGFzeW5jIChsaXN0T2ZDYXRlZ29yaWVzLCBlbmhhbmNlVGFnKSA9PiB7CiAgICBsZXQgcmVzcG9uc2UgPSBodG1sRGF0YTsKICAgIGxldCBkb2N1bWVudDsKCiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gInVuZGVmaW5lZCIpIHsKICAgICAgICBsZXQganNkb20gPSBhd2FpdCBpbXBvcnQoImpzZG9tIik7CiAgICAgICAgbGV0IHsgSlNET00gfSA9IGpzZG9tOwogICAgICAgIGxldCBkb20gPSBuZXcgSlNET00oaHRtbERhdGEpOwogICAgICAgIGRvY3VtZW50ID0gZG9tLndpbmRvdy5kb2N1bWVudDsKICAgICAgICByZXR1cm4gYW5ub3RhdGlvblByb2Nlc3MobGlzdE9mQ2F0ZWdvcmllcywgZW5oYW5jZVRhZywgZG9jdW1lbnQsIHJlc3BvbnNlKTsKICAgIH0gZWxzZSB7CiAgICAgICAgZG9jdW1lbnQgPSB3aW5kb3cuZG9jdW1lbnQ7CiAgICAgICAgcmV0dXJuIGFubm90YXRpb25Qcm9jZXNzKGxpc3RPZkNhdGVnb3JpZXMsIGVuaGFuY2VUYWcsIGRvY3VtZW50LCByZXNwb25zZSk7CiAgICB9Cn07CgoKCmxldCBlbmhhbmNlID0gYXN5bmMgKCkgPT4gewogICAgaWYgKCFpcHNEYXRhIHx8ICFpcHNEYXRhLmVudHJ5IHx8IGlwc0RhdGEuZW50cnkubGVuZ3RoID09PSAwKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJJUFMgaXMgZW1wdHkgb3IgaW52YWxpZC4iKTsKICAgIH0KICAgIGxldCBlbmhhbmNlVGFnID0gImhpZ2hsaWdodCI7CiAgICBsZXQgbGlzdE9mQ2F0ZWdvcmllc1RvU2VhcmNoID0gW3sgImNvZGUiOiAiZ3Jhdi0xIiwgInN5c3RlbSI6ICJodHRwOi8vZ3Jhdml0YXRlLWhlYWx0aC5ldS9jb2RlcyIgfV07IC8vd2hhdCB0byBsb29rIGluIGV4dGVuc2lvbnMgLW1hZGUgdXAgY29kZSBiZWNhdXNlIHRoZXJlIGlzIG5vbmUKCiAgICAvLyBIaWdobGlnaHQgPFFUIHByb2xvbmdhdGlvbiByaXNrPiBJRiBNZWRpY2F0aW9uUmVxdWVzdC5tZWRpY2F0aW9uID09IFtDaXRhbG9wcmFtXSAKICAgIC8vIEFORCBPYnNlcnZhdGlvbi5jb2RlID09ICJLKyIgKGxvaW5jIDI4MjMtMykgQU5EIE9ic2VydmF0aW9uLnZhbHVlIDwgMy41IG1tb2wvTAoKICAgIGNvbnN0IHBvdGFzc2l1bUNvZGVzID0gWyIyODIzLTMiLCAiNjI5OC00Il07IC8vIHdoYXQgdG8gbG9vayBpbiBJUFMgTGFiCiAgICBjb25zdCBjaXRhbG9wcmFtS2V5d29yZHMgPSBbImNpdGFsb3ByYW0iLCAiQ2l0YWxvcHJhbSJdOyAvLyB3aGF0IHRvIGxvb2sgaW4gbWVkaWNhdGlvbiByZXF1ZXN0IC8gc3RhdGVtZW50cwogICAgY29uc3QgY2l0YWxvcHJhbUNvZGVzID0gWyIyMDQ0NDciLCAiMzcyNzI5MDA5Il07Ly8gd2hhdCB0byBsb29rIGluIG1lZGljYXRpb24gcmVxdWVzdCAvIHN0YXRlbWVudHMKCiAgICBsZXQgaGFzTG93UG90YXNzaXVtID0gZmFsc2U7CiAgICBsZXQgdGFraW5nQ2l0YWxvcHJhbSA9IGZhbHNlOwoKICAgIC8vIEluZGV4IG1lZGljYXRpb25zIGJ5IHJlZmVyZW5jZSBJRAogICAgY29uc3QgbWVkaWNhdGlvbnNCeUlkID0gbmV3IE1hcCgpOwogICAgaXBzRGF0YS5lbnRyeS5mb3JFYWNoKChlbnRyeSkgPT4gewogICAgICAgIGlmIChlbnRyeS5yZXNvdXJjZT8ucmVzb3VyY2VUeXBlID09PSAiTWVkaWNhdGlvbiIgJiYgZW50cnkucmVzb3VyY2UuaWQpIHsKICAgICAgICAgICAgbWVkaWNhdGlvbnNCeUlkLnNldChgTWVkaWNhdGlvbi8ke2VudHJ5LnJlc291cmNlLmlkfWAsIGVudHJ5LnJlc291cmNlKTsKICAgICAgICB9CiAgICB9KTsKCiAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIGlwc0RhdGEuZW50cnkpIHsKICAgICAgICBjb25zdCByZXMgPSBlbnRyeS5yZXNvdXJjZTsKICAgICAgICBpZiAoIXJlcykgY29udGludWU7CgogICAgICAgIC8vIENoZWNrIHBvdGFzc2l1bQogICAgICAgIGlmICgKICAgICAgICAgICAgcmVzLnJlc291cmNlVHlwZSA9PT0gIk9ic2VydmF0aW9uIiAmJgogICAgICAgICAgICByZXMuY29kZT8uY29kaW5nICYmCiAgICAgICAgICAgIHR5cGVvZiByZXMudmFsdWVRdWFudGl0eT8udmFsdWUgPT09ICJudW1iZXIiCiAgICAgICAgKSB7CiAgICAgICAgICAgIGNvbnN0IGlzSyA9IHJlcy5jb2RlLmNvZGluZy5zb21lKAogICAgICAgICAgICAgICAgKGMpID0+CiAgICAgICAgICAgICAgICAgICAgcG90YXNzaXVtQ29kZXMuaW5jbHVkZXMoYy5jb2RlKSB8fAogICAgICAgICAgICAgICAgICAgIGMuZGlzcGxheT8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcygicG90YXNzaXVtIikKICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKGlzSyAmJiByZXMudmFsdWVRdWFudGl0eS52YWx1ZSA8IDMuNSkgewogICAgICAgICAgICAgICAgaGFzTG93UG90YXNzaXVtID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCLimqDvuI8gTG93IEsrOiIsIHJlcy52YWx1ZVF1YW50aXR5LnZhbHVlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gTWVkaWNhdGlvblN0YXRlbWVudCBvciBNZWRpY2F0aW9uUmVxdWVzdAogICAgICAgIGlmIChbIk1lZGljYXRpb25TdGF0ZW1lbnQiLCAiTWVkaWNhdGlvblJlcXVlc3QiXS5pbmNsdWRlcyhyZXMucmVzb3VyY2VUeXBlKSkgewogICAgICAgICAgICBsZXQgY29kZXMgPSBbXTsKCiAgICAgICAgICAgIC8vIENhc2UgMTogbWVkaWNhdGlvbkNvZGVhYmxlQ29uY2VwdAogICAgICAgICAgICBpZiAocmVzLm1lZGljYXRpb25Db2RlYWJsZUNvbmNlcHQ/LmNvZGluZykgewogICAgICAgICAgICAgICAgY29kZXMgPSByZXMubWVkaWNhdGlvbkNvZGVhYmxlQ29uY2VwdC5jb2Rpbmc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIENhc2UgMjogbWVkaWNhdGlvblJlZmVyZW5jZSB0byBNZWRpY2F0aW9uIHJlc291cmNlCiAgICAgICAgICAgIGlmIChyZXMubWVkaWNhdGlvblJlZmVyZW5jZT8ucmVmZXJlbmNlKSB7CiAgICAgICAgICAgICAgICBjb25zdCBtZWRSZWYgPSByZXMubWVkaWNhdGlvblJlZmVyZW5jZS5yZWZlcmVuY2U7CiAgICAgICAgICAgICAgICBjb25zdCBtZWQgPSBtZWRpY2F0aW9uc0J5SWQuZ2V0KG1lZFJlZik7CiAgICAgICAgICAgICAgICBpZiAobWVkPy5jb2RlPy5jb2RpbmcpIHsKICAgICAgICAgICAgICAgICAgICBjb2RlcyA9IGNvZGVzLmNvbmNhdChtZWQuY29kZS5jb2RpbmcpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBFdmFsdWF0ZSBhbGwgZm91bmQgY29kZXMKICAgICAgICAgICAgZm9yIChjb25zdCBjb2Rpbmcgb2YgY29kZXMpIHsKICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoQnlDb2RlID0gY2l0YWxvcHJhbUNvZGVzLmluY2x1ZGVzKGNvZGluZy5jb2RlKTsKICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoQnlUZXh0ID0gY2l0YWxvcHJhbUtleXdvcmRzLnNvbWUoKGt3KSA9PgogICAgICAgICAgICAgICAgICAgIChjb2RpbmcuZGlzcGxheSB8fCAiIikudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhrdykKICAgICAgICAgICAgICAgICk7CgogICAgICAgICAgICAgICAgaWYgKG1hdGNoQnlDb2RlIHx8IG1hdGNoQnlUZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgdGFraW5nQ2l0YWxvcHJhbSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIvCfkoogQ2l0YWxvcHJhbSBtYXRjaGVkIHZpYSBjb2RlIG9yIGRpc3BsYXk6IiwgY29kaW5nLmNvZGUpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKCiAgICAvLyBlUEkgdHJhc2xhdGlvbiBmcm9tIHRlcm1pbm9sb2d5IGNvZGVzIHRvIHRoZWlyIGh1bWFuIHJlZGFibGUgdHJhbnNsYXRpb25zIGluIHRoZSBzZWN0aW9ucwogICAgbGV0IGNvbXBvc2l0aW9ucyA9IDA7CiAgICBsZXQgY2F0ZWdvcmllcyA9IFtdOwogICAgZXBpLmVudHJ5LmZvckVhY2goKGVudHJ5KSA9PiB7CiAgICAgICAgaWYgKGVudHJ5LnJlc291cmNlLnJlc291cmNlVHlwZSA9PSAiQ29tcG9zaXRpb24iKSB7CiAgICAgICAgICAgIGNvbXBvc2l0aW9ucysrOwogICAgICAgICAgICAvL0l0ZXJhdGVkIHRocm91Z2ggdGhlIENvbmRpdGlvbiBlbGVtZW50IHNlYXJjaGluZyBmb3IgY29uZGl0aW9ucwogICAgICAgICAgICBlbnRyeS5yZXNvdXJjZS5leHRlbnNpb24uZm9yRWFjaCgoZWxlbWVudCkgPT4gewoKICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBwb3NpdGlvbiBvZiB0aGUgZXh0ZW5zaW9uWzFdIGlzIGNvcnJlY3QKICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LmV4dGVuc2lvblsxXS51cmwgPT0gImNvbmNlcHQiKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gU2VhcmNoIHRocm91Z2ggdGhlIGRpZmZlcmVudCB0ZXJtaW5vbG9naWVzIHRoYXQgbWF5IGJlIGF2YWlibGUgdG8gY2hlY2sgaW4gdGhlIGNvbmRpdGlvbgogICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LmV4dGVuc2lvblsxXS52YWx1ZUNvZGVhYmxlUmVmZXJlbmNlLmNvbmNlcHQgIT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZXh0ZW5zaW9uWzFdLnZhbHVlQ29kZWFibGVSZWZlcmVuY2UuY29uY2VwdC5jb2RpbmcuZm9yRWFjaCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjb2RpbmcpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRXh0ZW5zaW9uOiAiICsgZWxlbWVudC5leHRlbnNpb25bMF0udmFsdWVTdHJpbmcgKyAiOiIgKyBjb2RpbmcuY29kZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgY29kZSBpcyBpbiB0aGUgbGlzdCBvZiBjYXRlZ29yaWVzIHRvIHNlYXJjaAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaXN0T2ZDYXRlZ29yaWVzVG9TZWFyY2guc29tZShpdGVtID0+IGl0ZW0uY29kZSA9PT0gY29kaW5nLmNvZGUgJiYgaXRlbS5zeXN0ZW0gPT09IGNvZGluZy5zeXN0ZW0pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBjYXRlZ29yeSBpcyBhbHJlYWR5IGluIHRoZSBsaXN0IG9mIGNhdGVnb3JpZXMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcmllcy5wdXNoKGVsZW1lbnQuZXh0ZW5zaW9uWzBdLnZhbHVlU3RyaW5nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9KTsKICAgIGlmIChjb21wb3NpdGlvbnMgPT0gMCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignQmFkIGVQSTogbm8gY2F0ZWdvcnkgIkNvbXBvc2l0aW9uIiBmb3VuZCcpOwogICAgfQoKICAgIGlmIChjYXRlZ29yaWVzLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgLy8gdGhyb3cgbmV3IEVycm9yKCJObyBjYXRlZ29yaWVzIGZvdW5kIiwgY2F0ZWdvcmllcyk7CiAgICAgICAgcmV0dXJuIGh0bWxEYXRhOwogICAgfQogICAgaWYgKGhhc0xvd1BvdGFzc2l1bSAmJiB0YWtpbmdDaXRhbG9wcmFtKSB7CiAgICAgICAgcmV0dXJuIGF3YWl0IGFubm90YXRlSFRNTHNlY3Rpb24oY2F0ZWdvcmllcywgZW5oYW5jZVRhZyk7CiAgICB9CiAgICBlbHNlIHsKCiAgICAgICAgY29uc29sZS53YXJuKCJObyBRVCBwcm9sb25nYXRpb24gcmlzayBjb25kaXRpb24gbWV0LiIpOwogICAgICAgIHJldHVybiBodG1sRGF0YTsKICAgIH0KCn07CgoKZnVuY3Rpb24gZ2V0UmVwb3J0KGxhbmcpIHsKICAgIGNvbnNvbGUubG9nKCJHZW5lcmF0aW5nIHJlcG9ydCBpbiBsYW5ndWFnZToiLCBsYW5nKTsKICAgIHJldHVybiB7IG1lc3NhZ2U6IGdldEV4cGxhbmF0aW9uKGxhbmcpLCBzdGF0dXM6ICIiIH07CgoKfQoKLy8gLS0tIEdldCB1c2VyLWZhY2luZyByZXBvcnQgc2VudGVuY2UgaW4gdGhlIHNlbGVjdGVkIGxhbmd1YWdlIC0tLQpmdW5jdGlvbiBnZXRFeHBsYW5hdGlvbihsYW5nKSB7CiAgICBjb25zb2xlLmxvZygiR2VuZXJhdGluZyBleHBsYW5hdGlvbiBpbiBsYW5ndWFnZToiLCBsYW5nKTsKICAgIHJldHVybiAiIjsKfQoKLy8gLS0tIEV4cG9ydGVkIEFQSSAtLS0KcmV0dXJuIHsKICAgIGVuaGFuY2U6IGVuaGFuY2UsCiAgICBnZXRTcGVjaWZpY2F0aW9uOiBnZXRTcGVjaWZpY2F0aW9uLAogICAgZXhwbGFuYXRpb246IChsYW5ndWFnZSkgPT4gZ2V0RXhwbGFuYXRpb24obGFuZ3VhZ2UgfHwgbGFuZyksCiAgICByZXBvcnQ6IChsYW5ndWFnZSkgPT4gZ2V0UmVwb3J0KGxhbmd1YWdlIHx8IGxhbmcpLAp9Ow==",
      "_title": {
        "extension": [
          {
            "url": "http://hl7.org/fhir/StructureDefinition/translation",
            "extension": [
              {
                "url": "lang",
                "valueCode": "es"
              },
              {
                "url": "content",
                "valueString": "Lente para la diabetes"
              }
            ]
          },
          {
            "url": "http://hl7.org/fhir/StructureDefinition/translation",
            "extension": [
              {
                "url": "lang",
                "valueCode": "pt"
              },
              {
                "url": "content",
                "valueString": "Lente para a diabetes"
              }
            ]
          },
          {
            "url": "http://hl7.org/fhir/StructureDefinition/translation",
            "extension": [
              {
                "url": "lang",
                "valueCode": "da"
              },
              {
                "url": "content",
                "valueString": "Linse til diabetes"
              }
            ]
          }
        ]
      }
    }
  ]
}